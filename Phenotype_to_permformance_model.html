<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rosalee Elting">

<title>A Model to Connect Hummingbird Phenotypes to Flight Performance</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Phenotype_to_permformance_model_files/libs/clipboard/clipboard.min.js"></script>
<script src="Phenotype_to_permformance_model_files/libs/quarto-html/quarto.js"></script>
<script src="Phenotype_to_permformance_model_files/libs/quarto-html/popper.min.js"></script>
<script src="Phenotype_to_permformance_model_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Phenotype_to_permformance_model_files/libs/quarto-html/anchor.min.js"></script>
<link href="Phenotype_to_permformance_model_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Phenotype_to_permformance_model_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Phenotype_to_permformance_model_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Phenotype_to_permformance_model_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Phenotype_to_permformance_model_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#section" id="toc-section" class="nav-link active" data-scroll-target="#section"></a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions">Questions</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  <li><a href="#method" id="toc-method" class="nav-link" data-scroll-target="#method">Method</a>
  <ul class="collapse">
  <li><a href="#measurement-variables" id="toc-measurement-variables" class="nav-link" data-scroll-target="#measurement-variables">Measurement Variables</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"></a></li>
  </ul></li>
  <li><a href="#public-repository-data-for-calypte-anna" id="toc-public-repository-data-for-calypte-anna" class="nav-link" data-scroll-target="#public-repository-data-for-calypte-anna">Public Repository Data for <em>Calypte anna</em></a>
  <ul class="collapse">
  <li><a href="#exploring-data-for-calypte-anna" id="toc-exploring-data-for-calypte-anna" class="nav-link" data-scroll-target="#exploring-data-for-calypte-anna">Exploring Data for <em>Calypte anna</em></a>
  <ul class="collapse">
  <li><a href="#loading-libraries-and-data" id="toc-loading-libraries-and-data" class="nav-link" data-scroll-target="#loading-libraries-and-data">Loading Libraries and Data</a></li>
  <li><a href="#visualizing-original-data" id="toc-visualizing-original-data" class="nav-link" data-scroll-target="#visualizing-original-data">Visualizing Original Data</a></li>
  <li><a href="#investigating-distributions-of-original-data" id="toc-investigating-distributions-of-original-data" class="nav-link" data-scroll-target="#investigating-distributions-of-original-data">Investigating Distributions of Original Data</a></li>
  </ul></li>
  <li><a href="#generating-fake-data" id="toc-generating-fake-data" class="nav-link" data-scroll-target="#generating-fake-data">Generating Fake Data</a>
  <ul class="collapse">
  <li><a href="#weight-lifted" id="toc-weight-lifted" class="nav-link" data-scroll-target="#weight-lifted">Weight Lifted</a></li>
  <li><a href="#horizontal-acceleration" id="toc-horizontal-acceleration" class="nav-link" data-scroll-target="#horizontal-acceleration">Horizontal Acceleration</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#running-a-phenotype-performance-model" id="toc-running-a-phenotype-performance-model" class="nav-link" data-scroll-target="#running-a-phenotype-performance-model">Running a Phenotype-Performance Model</a>
  <ul class="collapse">
  <li><a href="#creating-a-stan-model" id="toc-creating-a-stan-model" class="nav-link" data-scroll-target="#creating-a-stan-model">Creating a Stan Model</a></li>
  <li><a href="#running-stan-model" id="toc-running-stan-model" class="nav-link" data-scroll-target="#running-stan-model">Running Stan Model</a></li>
  </ul></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"></a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">A Model to Connect Hummingbird Phenotypes to Flight Performance</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rosalee Elting </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="section" class="level1">
<h1></h1>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>For my project, I propose methods to understand the social dominance of hummingbirds and how social hierarchies are maintained. To evaluate this, I will use both field and lab work to create a model that reflects the phenotype &gt; performance &gt; fitness paradigm presented by Arnold in 1983 (Arnold, 1983). The actual variables I will measure are outlined below in the [###Measurement Variables] section. Overall, I will set these experiments up with dyadic combinations of trials between two male hummingbirds where a limiting resource is introduced (nectar or perches) to establish which individual maintains access to this resource and chases away an opponent. I will then connect these wins to traits about the individual that are variable. These will be phenotypic morphometric traits, as well as performance measurements from metabolic and flight kinematic measures. Lastly, with these characteristics I hope to understand how phenotypes and fitness connect to performance in an ecological landscape. I hope to do this by combining 1. fight data from the field and those winning individuals’ phenotypes and 2. more fine-tuned phenotypic data and one-on-one fight results from lab trials. With this, I seek to establish what phenotypes and fitness performance traits are most predictable of social dominance hierarchies in hummingbirds.</p>
</section>
<section id="section-1" class="level1">
<h1></h1>
</section>
<section id="questions" class="level1">
<h1>Questions</h1>
<p>Based on the above introduction, I ask the following two questions:</p>
<ol type="1">
<li>What variables in a complex suite of hummingbird morphological traits and flight maneuvers predict flight characteristics that are associated with increased speed and maneuverability?</li>
</ol>
</section>
<section id="section-2" class="level1">
<h1></h1>
</section>
<section id="method" class="level1">
<h1>Method</h1>
<p>To investigate this, I hope to use the Arnold’s Paradigm proposed in his 1983 paper. The framework below (Bergmann and McElroy, 2014) illustrates this experiment method graphically (below.)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="matrix_test.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">(Bergmann and McElroy, 2014)</figcaption><p></p>
</figure>
</div>
<section id="measurement-variables" class="level2">
<h2 class="anchored" data-anchor-id="measurement-variables">Measurement Variables</h2>
<p>I will be using a modified version of this Arnold framework in [Method] , but instead of comparing the phenotype-performance relationship of each species, I will be evaluating this on an individual level. My measurements, and their categories, will be:</p>
<p><strong>Phenotypic Measures:</strong></p>
<ul>
<li><p>Wing Aspect Ratio</p></li>
<li><p>Body Mass</p></li>
<li><p>Burst Muscle Capacity</p></li>
</ul>
<p><strong>Performance Measures:</strong></p>
<ul>
<li><p>Flight accelerations and deceleration</p></li>
<li><p>Arcing turn speed and radii</p></li>
<li><p>Percentage of turns that are complex pitch-roll turns</p></li>
</ul>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3"></h2>
<p>Data and Model</p>
<p>I will be holding 6 Calliope Hummingbirds (<em>Selasphorus calliope</em>) captive in the spring of 2023. As I do not yet have data, I will find public repositories of data similar to that which I will collect. The data I am looking for will likely come from multiple sources and will be of two forms:</p>
<ol type="1">
<li><p>One-on-one dyadic fight results, which I can integrate into a Bayes framework to use as priors to predict winners of unique dyads. I would then like to integrate morphometrics to these predictors to see if they co-vary. Data from Márquez-Luna et al.&nbsp;2022. provides dyadic win-loss data, but only as sums and it is interspecific, so I am hopeful to find another source with intraspecific competitions results.</p></li>
<li><p>I can use prior data collected by the Tobalske lab, potentially supplemented with other published data on Calliope hummingbirds to provide morphometric data. I can then hopefully find open source data on the fitness (metabolic rate and body composition) measures so that I can model the regressions between each phenotype and fitness combination in the matrix. If I have difficulty finding this data for Calliope hummingbirds, I will likely find it for Calypte anna instead, as it is more greatly studied, metabolic measures have already been published,and I have collaborators studying this species.</p></li>
</ol>
</section>
</section>
<section id="public-repository-data-for-calypte-anna" class="level1">
<h1>Public Repository Data for <em>Calypte anna</em></h1>
<p>Below is code I have written to explore data collected in Segre et al., 2015, an <em>eLife</em> publication exploring phenotypes and flight performance. The authors evaluated this data using an <strong>information-theoretic approach</strong> which compares the several possible scenarios and weights their relative predictive importance. The authors evaluated these data using a canned R function, nlme, therefore I would like to write a model to evaluate the same data and assess if I come to the same conclusions.</p>
<section id="exploring-data-for-calypte-anna" class="level2">
<h2 class="anchored" data-anchor-id="exploring-data-for-calypte-anna">Exploring Data for <em>Calypte anna</em></h2>
<section id="loading-libraries-and-data" class="level3">
<h3 class="anchored" data-anchor-id="loading-libraries-and-data">Loading Libraries and Data</h3>
<p>First, I will load the necessary libraries</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.0     ✔ purrr   1.0.1
✔ tibble  3.1.8     ✔ dplyr   1.1.0
✔ tidyr   1.3.0     ✔ stringr 1.5.0
✔ readr   2.1.3     ✔ forcats 0.5.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rstatix'

The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: StanHeaders
rstan (Version 2.21.8, GitRev: 2e1f913d3ca3)
For execution on a local, multicore CPU with excess RAM we recommend calling
options(mc.cores = parallel::detectCores()).
To avoid recompilation of unchanged Stan programs, we recommend calling
rstan_options(auto_write = TRUE)

Attaching package: 'rstan'

The following object is masked from 'package:tidyr':

    extract</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I will then load the csv of data from this publication</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>annas <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"annasairdata.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 52 Columns: 40
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (3): bird, experiment, solocomp
dbl (37): vidid, capture_doy, trial_doy, daysafter, daysafterSTD, wing.lengt...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(annas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 40
  bird   vidid experim…¹ soloc…² captu…³ trial…⁴ daysa…⁵ daysa…⁶ wing.…⁷ wing.ar
  &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 GAS01 143321 Van       solo         24      51      27  -0.756    51.6    7.13
2 GAS01 163920 Van       comp         24      51      27  -0.756    51.6    7.13
3 GAS02 150149 Van       solo        -20      56      76   0.447    52.9    7.83
4 GAS02 163920 Van       comp        -20      51      71   0.324    52.9    7.83
5 GAS03 102128 Van       solo         51      58       7  -1.25     55.4    7.59
6 GAS03  94818 Van       comp         51      61      10  -1.17     55.4    7.59
# … with 30 more variables: mass &lt;dbl&gt;, w.lifted &lt;dbl&gt;, massSTD &lt;dbl&gt;,
#   wing.lengthSTD &lt;dbl&gt;, wing.arSTD &lt;dbl&gt;, w.liftedSTD &lt;dbl&gt;,
#   ss.total_vel &lt;dbl&gt;, ss.hor_acel &lt;dbl&gt;, ss.hor_decel &lt;dbl&gt;,
#   ss.pitch_down &lt;dbl&gt;, ss.pitch_up &lt;dbl&gt;, ss.vert_down_acel &lt;dbl&gt;,
#   ss.vert_up_acel &lt;dbl&gt;, ss.yaw &lt;dbl&gt;, ss.arc &lt;dbl&gt;, ss.pitch_roll &lt;dbl&gt;,
#   PRTpercent &lt;dbl&gt;, mean.total_vel &lt;dbl&gt;, mean.hor_acel &lt;dbl&gt;,
#   mean.hor_decel &lt;dbl&gt;, mean.pitch_down &lt;dbl&gt;, mean.pitch_up &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>I next am filtering and cleaning this data. I am removing data from solo trials, and keeping only competitive trials. The assumption is that birds perform flight maneuvers with increases speed or maneuverability in the presence of another individual. Therefore, I only include her data from competitive trials. Further I am selecting data I am interested in from this original data set.</p>
<p>In this code chunk, I also create a summary data frame with means and variances for each variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>annas_clean <span class="ot">&lt;-</span> annas <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(solocomp <span class="sc">==</span> <span class="st">"comp"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"mass"</span>, <span class="st">"massSTD"</span>, <span class="st">"w.lifted"</span>, <span class="st">"w.liftedSTD"</span>, <span class="st">"wing.ar"</span>, <span class="st">"wing.arSTD"</span>, <span class="st">"wing.length"</span>, <span class="st">"wing.lengthSTD"</span>, <span class="st">"mean.hor_acel"</span>, <span class="st">"mean.hor_decel"</span>, <span class="st">"mean.arc_avghvel"</span>, <span class="st">"mean.total_vel"</span>, <span class="st">"ss.pitch_roll"</span>, <span class="st">"mean.pr_time"</span>, <span class="st">"mean.pr_degrees"</span>, <span class="st">"mean.arc_force"</span>, <span class="st">"PRTpercent"</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>annas_mean <span class="ot">&lt;-</span>  <span class="fu">as.data.frame</span>(annas_clean) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">colnames</span>(annas_clean), <span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm=</span><span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">colnames</span>(annas_clean)) <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"name"</span>))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>annas_var <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(annas_clean) <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">colnames</span>(annas_clean), <span class="sc">~</span><span class="fu">var</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">colnames</span>(annas_clean)) <span class="sc">%&gt;%</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"name"</span>))</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>annas_summ <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>( <span class="cn">NA</span>, </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ncol =</span> <span class="dv">3</span>, </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">nrow =</span> <span class="dv">17</span>))</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">rownames =</span> <span class="fu">colnames</span>(annas_clean))</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>annas_summ[,<span class="dv">1</span>] <span class="ot">&lt;-</span> names</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>annas_summ[,<span class="dv">2</span>] <span class="ot">&lt;-</span> annas_mean</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>annas_summ[,<span class="dv">3</span>] <span class="ot">&lt;-</span> annas_var</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(annas_summ) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"variable"</span>, <span class="st">"mean"</span>, <span class="st">"var"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualizing-original-data" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-original-data">Visualizing Original Data</h3>
<div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="dv">0</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a> viz <span class="ot">&lt;-</span> annas_clean <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">cross_join</span>(x, <span class="at">copy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a> colNames <span class="ot">&lt;-</span> <span class="fu">names</span>(viz)[<span class="dv">1</span><span class="sc">:</span><span class="dv">17</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> colNames) {</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>   plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(viz, <span class="fu">aes_string</span>(<span class="at">x=</span> viz<span class="sc">$</span>y, <span class="at">y =</span> i))<span class="sc">+</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_violin</span>(<span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>))<span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_classic</span>()</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plot)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a> }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation ideoms with `aes()`</code></pre>
</div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-9.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-12.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-13.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-14.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-15.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-16.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-17.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="investigating-distributions-of-original-data" class="level3">
<h3 class="anchored" data-anchor-id="investigating-distributions-of-original-data">Investigating Distributions of Original Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>normality_check <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(annas_clean)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>columns <span class="ot">&lt;-</span> <span class="fu">names</span>(normality_check)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> columns) {</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">hist</span>(<span class="at">x =</span> normality_check[,i])</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  plot2 <span class="ot">&lt;-</span> <span class="fu">qqnorm</span>(normality_check[,i]) </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qqline</span>(normality_check[,i])</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plot)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plot2)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
 [1] 4.0 4.2 4.4 4.6 4.8 5.0 5.2 5.4 5.6 5.8

$counts
[1]  2  4 12  8  2  0  0  2  2

$density
[1] 0.3125 0.6250 1.8750 1.2500 0.3125 0.0000 0.0000 0.3125 0.3125

$mids
[1] 4.1 4.3 4.5 4.7 4.9 5.1 5.3 5.5 5.7

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1] -0.19709908 -1.22985876  0.19709908  0.27769044 -1.41779714  0.62609901
 [7] -0.83051088  0.36012989  0.72451438  0.83051088 -0.53340971 -0.44509652
[13] -0.72451438 -0.62609901  0.44509652  0.53340971 -1.07751557 -0.94678176
[19] -0.36012989 -0.27769044 -2.15387469 -1.67593972  0.94678176  1.07751557
[25]  1.22985876  1.41779714 -0.11776987 -0.03917609  0.03917609  0.11776987
[31]  1.67593972  2.15387469

$y
 [1] 4.50 4.37 4.62 4.63 4.23 4.75 4.44 4.69 4.80 4.80 4.47 4.47 4.44 4.44 4.74
[16] 4.74 4.40 4.40 4.48 4.48 4.09 4.09 4.82 4.82 5.58 5.58 4.58 4.58 4.59 4.59
[31] 5.61 5.61</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1] -1.5 -1.0 -0.5  0.0  0.5  1.0  1.5  2.0  2.5

$counts
[1]  3  6 11  8  0  0  0  4

$density
[1] 0.1875 0.3750 0.6875 0.5000 0.0000 0.0000 0.0000 0.2500

$mids
[1] -1.25 -0.75 -0.25  0.25  0.75  1.25  1.75  2.25

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1] -0.19709908 -1.22985876  0.19709908  0.27769044 -1.41779714  0.62609901
 [7] -0.83051088  0.36012989  0.72451438  0.83051088 -0.53340971 -0.44509652
[13] -0.72451438 -0.62609901  0.44509652  0.53340971 -1.07751557 -0.94678176
[19] -0.36012989 -0.27769044 -2.15387469 -1.67593972  0.94678176  1.07751557
[25]  1.22985876  1.41779714 -0.11776987 -0.03917609  0.03917609  0.11776987
[31]  1.67593972  2.15387469

$y
 [1] -0.40953637 -0.74470172 -0.10015296 -0.07437101 -1.10564903  0.23501239
 [7] -0.56422807  0.08032069  0.36392215  0.36392215 -0.48688222 -0.48688222
[13] -0.56422807 -0.56422807  0.20923044  0.20923044 -0.66735587 -0.66735587
[19] -0.46110027 -0.46110027 -1.46659633 -1.46659633  0.41548605  0.41548605
[25]  2.37491428  2.37491428 -0.20328076 -0.20328076 -0.17749881 -0.17749881
[31]  2.45226013  2.45226013</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1] 4.0 4.5 5.0 5.5 6.0 6.5 7.0 7.5

$counts
[1]  2  1  3 12  9  2  3

$density
[1] 0.1250 0.0625 0.1875 0.7500 0.5625 0.1250 0.1875

$mids
[1] 4.25 4.75 5.25 5.75 6.25 6.75 7.25

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1]  1.41779714 -1.41779714 -0.44509652 -0.36012989  0.53340971 -0.94678176
 [7]  0.62609901  0.72451438 -1.22985876 -1.07751557 -0.83051088 -0.72451438
[13] -2.15387469 -1.67593972 -0.62609901 -0.53340971  0.19709908  0.27769044
[19] -0.27769044 -0.19709908  0.83051088  0.94678176  1.67593972  2.15387469
[25] -0.11776987 -0.03917609  1.07751557  1.22985876  0.36012989  0.44509652
[31]  0.03917609  0.11776987

$y
 [1] 7.22 4.88 5.66 5.66 6.44 5.27 6.44 6.44 5.20 5.20 5.60 5.60 4.00 4.00 5.60
[16] 5.60 6.05 6.05 5.66 5.66 6.44 6.44 7.24 7.24 5.66 5.66 6.75 6.75 6.30 6.30
[31] 6.00 6.00</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1] -2.0 -1.5 -1.0 -0.5  0.0  0.5  1.0  1.5  2.0

$counts
[1] 4 3 4 4 4 8 1 4

$density
[1] 0.2500 0.1875 0.2500 0.2500 0.2500 0.5000 0.0625 0.2500

$mids
[1] -1.75 -1.25 -0.75 -0.25  0.25  0.75  1.25  1.75

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1]  1.07751557 -0.72451438 -0.03917609 -1.07751557  0.03917609 -0.62609901
 [7]  0.44509652  0.94678176  0.72451438  0.83051088  0.27769044  0.36012989
[13] -2.15387469 -1.67593972  0.11776987  0.19709908 -0.94678176 -0.83051088
[19] -1.41779714 -1.22985876  0.53340971  0.62609901  1.67593972  2.15387469
[25] -0.53340971 -0.44509652  1.22985876  1.41779714 -0.36012989 -0.27769044
[31] -0.19709908 -0.11776987

$y
 [1]  1.33771804 -0.79240898  0.00912714 -1.39696563  0.25468224 -0.73668168
 [7]  0.56631868  0.75821018  0.70125357  0.70125357  0.55201105  0.55201105
[13] -1.71174522 -1.71174522  0.45848060  0.45848060 -1.09417237 -1.09417237
[19] -1.60648094 -1.60648094  0.64463562  0.64463562  1.51133370  1.51133370
[25] -0.51954029 -0.51954029  1.50251862  1.50251862 -0.37287335 -0.37287335
[31] -0.06542098 -0.06542098</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1] 7.0 7.2 7.4 7.6 7.8 8.0 8.2 8.4 8.6

$counts
[1] 2 3 4 8 7 2 2 4

$density
[1] 0.31250 0.46875 0.62500 1.25000 1.09375 0.31250 0.31250 0.62500

$mids
[1] 7.1 7.3 7.5 7.7 7.9 8.1 8.3 8.5

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1] -2.15387469  0.27769044 -0.62609901 -1.67593972 -1.41779714 -0.94678176
 [7] -1.22985876 -1.07751557  1.67593972  2.15387469  0.94678176  1.07751557
[13]  1.22985876  1.41779714  0.72451438  0.83051088 -0.83051088 -0.72451438
[19] -0.53340971 -0.44509652  0.36012989  0.44509652 -0.19709908 -0.11776987
[25]  0.11776987  0.19709908  0.53340971  0.62609901 -0.36012989 -0.27769044
[31] -0.03917609  0.03917609

$y
 [1] 7.127 7.833 7.593 7.130 7.278 7.557 7.345 7.366 8.461 8.461 8.231 8.231
[13] 8.439 8.439 8.155 8.155 7.585 7.585 7.634 7.634 7.977 7.977 7.666 7.666
[25] 7.806 7.806 7.993 7.993 7.642 7.642 7.749 7.749</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-12.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1] -2.0 -1.5 -1.0 -0.5  0.0  0.5  1.0  1.5  2.0

$counts
[1] 2 3 3 9 3 6 2 4

$density
[1] 0.1250 0.1875 0.1875 0.5625 0.1875 0.3750 0.1250 0.2500

$mids
[1] -1.75 -1.25 -0.75 -0.25  0.25  0.75  1.25  1.75

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1] -2.15387469  0.27769044 -0.62609901 -1.67593972 -1.41779714 -0.94678176
 [7] -1.22985876 -1.07751557  1.67593972  2.15387469  0.94678176  1.07751557
[13]  1.22985876  1.41779714  0.72451438  0.83051088 -0.83051088 -0.72451438
[19] -0.53340971 -0.44509652  0.36012989  0.44509652 -0.19709908 -0.11776987
[25]  0.11776987  0.19709908  0.53340971  0.62609901 -0.36012989 -0.27769044
[31] -0.03917609  0.03917609

$y
 [1] -1.71497799  0.14401197 -0.48793929 -1.70707860 -1.31737532 -0.58273198
 [7] -1.14095560 -1.08565986  1.79761777  1.79761777  1.19199781  1.19199781
[13]  1.73968891  1.73968891  0.99187991  0.99187991 -0.50900433 -0.50900433
[19] -0.37998095 -0.37998095  0.52318273  0.52318273 -0.29572078 -0.29572078
[25]  0.07291745  0.07291745  0.56531281  0.56531281 -0.35891591 -0.35891591
[31] -0.07717097 -0.07717097</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-13.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-14.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1] 44 46 48 50 52 54 56

$counts
[1]  2  4 10  7  7  2

$density
[1] 0.031250 0.062500 0.156250 0.109375 0.109375 0.031250

$mids
[1] 45 47 49 51 53 55

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1]  0.53340971  1.07751557  2.15387469  1.67593972  0.94678176  1.41779714
 [7]  0.62609901  1.22985876  0.72451438  0.83051088  0.36012989  0.44509652
[13] -0.44509652 -0.36012989  0.03917609  0.11776987 -0.83051088 -0.72451438
[19] -0.11776987 -0.03917609 -2.15387469 -1.67593972  0.19709908  0.27769044
[25] -0.62609901 -0.53340971 -0.27769044 -0.19709908 -1.07751557 -0.94678176
[31] -1.41779714 -1.22985876

$y
 [1] 51.623 52.871 55.445 54.228 52.549 53.641 52.132 53.521 52.176 52.176
[11] 51.522 51.522 49.188 49.188 50.743 50.743 49.026 49.026 49.914 49.914
[21] 45.760 45.760 51.368 51.368 49.114 49.114 49.866 49.866 47.869 47.869
[31] 46.803 46.803</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-15.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-16.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1] -2.0 -1.5 -1.0 -0.5  0.0  0.5  1.0  1.5  2.0

$counts
[1] 4 2 6 4 7 5 3 1

$density
[1] 0.2500 0.1250 0.3750 0.2500 0.4375 0.3125 0.1875 0.0625

$mids
[1] -1.75 -1.25 -0.75 -0.25  0.25  0.75  1.25  1.75

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1]  0.53340971  1.07751557  2.15387469  1.67593972  0.94678176  1.41779714
 [7]  0.62609901  1.22985876  0.72451438  0.83051088  0.36012989  0.44509652
[13] -0.44509652 -0.36012989  0.03917609  0.11776987 -0.83051088 -0.72451438
[19] -0.11776987 -0.03917609 -2.15387469 -1.67593972  0.19709908  0.27769044
[25] -0.62609901 -0.53340971 -0.27769044 -0.19709908 -1.07751557 -0.94678176
[31] -1.41779714 -1.22985876

$y
 [1]  0.41196395  0.92286254  1.97659088  1.47838288  0.79104415  1.23808042
 [7]  0.62033525  1.18895555  0.63834770  0.63834770  0.37061719  0.37061719
[13] -0.58486143 -0.58486143  0.05171494  0.05171494 -0.65117999 -0.65117999
[19] -0.28765600 -0.28765600 -1.98819506 -1.98819506  0.30757361  0.30757361
[25] -0.61515509 -0.61515509 -0.30730594 -0.30730594 -1.12482556 -1.12482556
[31] -1.56121811 -1.56121811</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-17.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-18.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1]  2  3  4  5  6  7  8  9 10

$counts
[1]  1  4  2  3  5 11  5  1

$density
[1] 0.03125 0.12500 0.06250 0.09375 0.15625 0.34375 0.15625 0.03125

$mids
[1] 2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1] -1.07751557 -1.67593972 -0.94678176 -1.22985876 -2.15387469 -1.41779714
 [7] -0.72451438 -0.83051088  0.94678176  0.72451438  0.11776987  1.67593972
[13] -0.36012989  0.19709908  0.03917609  0.36012989  0.62609901 -0.11776987
[19] -0.53340971 -0.44509652 -0.19709908 -0.62609901  1.07751557  0.27769044
[25] -0.03917609  0.53340971  1.41779714  2.15387469  0.44509652  1.22985876
[31] -0.27769044  0.83051088

$y
 [1] 3.890672 3.231285 4.808738 3.645144 2.875872 3.516435 5.683158 4.874083
 [9] 8.011522 7.910500 7.507671 8.738960 6.173588 7.518970 7.326716 7.608495
[17] 7.851499 6.918311 5.939729 6.007211 6.701496 5.801163 8.321902 7.532586
[25] 7.119299 7.816501 8.535760 9.400748 7.761859 8.415416 6.556105 7.975860</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-19.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-20.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1] -10  -9  -8  -7  -6  -5  -4  -3

$counts
[1]  1 13  6  4  4  0  4

$density
[1] 0.03125 0.40625 0.18750 0.12500 0.12500 0.00000 0.12500

$mids
[1] -9.5 -8.5 -7.5 -6.5 -5.5 -4.5 -3.5

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1]  1.07751557  1.67593972  0.94678176  1.41779714  1.22985876  2.15387469
 [7]  0.83051088  0.72451438 -0.83051088 -0.62609901  0.11776987 -0.72451438
[13]  0.36012989 -0.44509652 -0.27769044 -0.03917609 -0.19709908  0.19709908
[19]  0.62609901  0.53340971  0.27769044  0.44509652 -1.67593972 -0.11776987
[25] -0.53340971 -1.22985876 -1.41779714 -2.15387469 -0.36012989 -1.07751557
[31]  0.03917609 -0.94678176

$y
 [1] -5.023197 -3.633288 -5.232813 -3.684881 -3.708440 -3.594767 -5.325482
 [8] -5.457998 -8.525116 -8.238200 -7.385437 -8.479650 -6.909063 -8.111643
[15] -8.017739 -7.725070 -8.015539 -7.274615 -6.284718 -6.495897 -7.132975
[22] -6.601818 -8.808847 -7.868638 -8.222534 -8.612609 -8.685142 -9.027618
[29] -8.110864 -8.586173 -7.432712 -8.525387</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-21.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-22.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
 [1] 0.6 0.8 1.0 1.2 1.4 1.6 1.8 2.0 2.2 2.4

$counts
[1]  1  1  4  1  2  8 12  2  1

$density
[1] 0.15625 0.15625 0.62500 0.15625 0.31250 1.25000 1.87500 0.31250 0.15625

$mids
[1] 0.7 0.9 1.1 1.3 1.5 1.7 1.9 2.1 2.3

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1] -0.83051088 -1.67593972 -1.41779714 -2.15387469 -0.94678176 -1.22985876
 [7] -0.62609901 -1.07751557  0.83051088  1.22985876  0.03917609  0.36012989
[13] -0.53340971 -0.19709908 -0.36012989  0.11776987  1.07751557  0.19709908
[19] -0.44509652 -0.27769044  0.53340971 -0.11776987  0.72451438  1.41779714
[25] -0.72451438  0.94678176  1.67593972  2.15387469  0.27769044  0.62609901
[31] -0.03917609  0.44509652

$y
 [1] 1.3081290 0.8936953 1.0528009 0.7920078 1.1001789 1.0588378 1.4638829
 [8] 1.0942594 1.9624332 1.9877641 1.7927165 1.8685049 1.7213091 1.7620721
[15] 1.7358641 1.8399743 1.9822478 1.8425181 1.7245821 1.7389694 1.9302044
[22] 1.7639578 1.9534537 2.1086957 1.4609616 1.9696228 2.1684372 2.2601229
[29] 1.8467551 1.9323678 1.7748309 1.9251616</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-23.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-24.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1] 1.0 1.5 2.0 2.5 3.0 3.5

$counts
[1]  2  6  7 15  2

$density
[1] 0.1250 0.3750 0.4375 0.9375 0.1250

$mids
[1] 1.25 1.75 2.25 2.75 3.25

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1] -1.07751557 -1.67593972 -1.22985876 -0.94678176 -2.15387469 -1.41779714
 [7] -0.72451438 -0.83051088  1.67593972  0.53340971 -0.44509652  0.72451438
[13]  0.94678176  0.83051088  2.15387469  0.11776987 -0.19709908 -0.36012989
[19] -0.53340971 -0.62609901  0.27769044 -0.03917609  0.44509652  0.36012989
[25]  0.03917609  1.07751557  1.22985876  1.41779714 -0.27769044  0.62609901
[31] -0.11776987  0.19709908

$y
 [1] 1.630470 1.394872 1.583581 1.661268 1.247033 1.551994 1.813380 1.746114
 [9] 3.014889 2.728564 2.283000 2.731522 2.770766 2.732418 3.228468 2.599488
[17] 2.428925 2.310493 2.282409 2.097170 2.650000 2.509762 2.705257 2.652035
[25] 2.537788 2.776236 2.779197 2.982842 2.351355 2.729855 2.494523 2.604846</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-25.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-26.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1]    0  200  400  600  800 1000 1200 1400

$counts
[1] 14 12  4  0  1  0  1

$density
[1] 0.00218750 0.00187500 0.00062500 0.00000000 0.00015625 0.00000000 0.00015625

$mids
[1]  100  300  500  700  900 1100 1300

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1] -0.62609901 -1.67593972  0.72451438 -1.22985876 -1.07751557 -0.36012989
 [7] -0.53340971  0.27769044  1.07751557  1.67593972  0.44509652 -0.94678176
[13] -0.19709908  0.36012989 -0.83051088  2.15387469 -0.27769044  0.83051088
[19]  0.62609901  0.94678176  0.11776987  0.19709908 -0.03917609  0.53340971
[25] -0.11776987  1.22985876 -0.44509652 -1.41779714  1.41779714  0.03917609
[31] -0.72451438 -2.15387469

$y
 [1]  113   37  370   52   76  183  113  301  462  846  320   81  198  304   96
[16] 1228  194  378  331  423  264  269  212  321  210  534  125   51  551  259
[31]  111   29</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-27.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-28.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1] 0.35 0.40 0.45 0.50 0.55 0.60 0.65

$counts
[1]  3 13 12  2  1  1

$density
[1] 1.875 8.125 7.500 1.250 0.625 0.625

$mids
[1] 0.375 0.425 0.475 0.525 0.575 0.625

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1]  0.53340971  1.67593972  1.07751557  0.83051088  2.15387469  1.22985876
 [7]  1.41779714  0.72451438 -1.67593972 -2.15387469 -1.41779714 -1.07751557
[13]  0.44509652 -0.11776987 -0.94678176 -0.36012989 -0.44509652  0.11776987
[19] -0.03917609  0.94678176 -0.53340971  0.36012989 -1.22985876 -0.19709908
[25]  0.03917609 -0.62609901 -0.72451438  0.19709908  0.27769044 -0.83051088
[31]  0.62609901 -0.27769044

$y
 [1] 0.4710177 0.5518919 0.4894865 0.4846154 0.6030921 0.5172678 0.5262281
 [8] 0.4796346 0.3926840 0.3828073 0.3961838 0.4069753 0.4688384 0.4413980
[15] 0.4150521 0.4337541 0.4330928 0.4575794 0.4493051 0.4853073 0.4306061
[22] 0.4686989 0.4041038 0.4399068 0.4533571 0.4292135 0.4291600 0.4592157
[29] 0.4595833 0.4285441 0.4791441 0.4379310</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-29.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-30.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1]  20  40  60  80 100 120 140 160 180

$counts
[1]  1  0  0  0  2 11 17  1

$density
[1] 0.0015625 0.0000000 0.0000000 0.0000000 0.0031250 0.0171875 0.0265625
[8] 0.0015625

$mids
[1]  30  50  70  90 110 130 150 170

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1] -2.15387469 -0.83051088  1.41779714 -1.07751557 -1.22985876 -0.94678176
 [7] -1.41779714 -1.67593972  1.22985876 -0.44509652  0.27769044  0.72451438
[13] -0.11776987  0.83051088  2.15387469  1.07751557  0.11776987 -0.03917609
[19] -0.62609901 -0.72451438 -0.36012989  0.53340971 -0.27769044  0.03917609
[25] -0.53340971  1.67593972 -0.19709908  0.19709908  0.62609901  0.94678176
[31]  0.36012989  0.44509652

$y
 [1]  35.10664 129.57679 158.39823 127.89120 121.06144 128.85237 114.10998
 [8] 104.71457 158.27781 135.40465 150.59965 154.22330 141.57012 156.88531
[15] 164.42228 158.17472 146.06139 143.39655 132.88958 131.86684 135.50588
[22] 153.04967 137.55892 145.40832 133.41204 159.79031 137.85989 148.74437
[29] 153.76176 157.54786 151.55575 152.99654</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-31.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-32.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
 [1]  3  4  5  6  7  8  9 10 11 12

$counts
[1] 3 3 2 7 6 4 5 1 1

$density
[1] 0.09375 0.09375 0.06250 0.21875 0.18750 0.12500 0.15625 0.03125 0.03125

$mids
[1]  3.5  4.5  5.5  6.5  7.5  8.5  9.5 10.5 11.5

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1] -2.15387469 -1.07751557 -0.83051088 -0.72451438 -1.67593972 -1.41779714
 [7] -1.22985876 -0.94678176  1.41779714  0.94678176 -0.19709908 -0.11776987
[13]  0.44509652 -0.27769044 -0.62609901  0.53340971 -0.44509652 -0.53340971
[19]  0.11776987  0.03917609  0.19709908 -0.36012989  1.07751557  0.83051088
[25] -0.03917609  0.27769044  1.22985876  1.67593972  0.72451438  2.15387469
[31]  0.36012989  0.62609901

$y
 [1]  3.136821  4.463386  5.436229  5.450587  3.759559  3.950278  4.230113
 [8]  4.779340  9.762163  9.208000  6.900293  6.915988  8.041911  6.886189
[15]  6.130149  8.107901  6.721441  6.333255  7.579317  7.400137  7.593697
[22]  6.861476  9.258847  9.011321  7.377045  7.816760  9.303589 10.622760
[29]  8.786355 11.145158  7.963540  8.555708</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-33.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-5-34.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
[1] 0.3 0.4 0.5 0.6 0.7 0.8 0.9

$counts
[1]  2  2  6  9 10  3

$density
[1] 0.6250 0.6250 1.8750 2.8125 3.1250 0.9375

$mids
[1] 0.35 0.45 0.55 0.65 0.75 0.85

$xname
[1] "normality_check[, i]"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"
$x
 [1]  1.41779714 -2.15387469 -0.83051088 -1.67593972 -0.19709908 -1.41779714
 [7] -0.03917609  2.15387469 -0.72451438 -0.36012989  0.03917609  1.67593972
[13] -1.22985876  0.11776987  0.53340971  0.72451438  0.36012989  0.44509652
[19] -0.11776987  0.27769044 -0.62609901  1.07751557 -0.94678176 -0.44509652
[25]  0.94678176  1.22985876 -0.53340971 -1.07751557  0.83051088  0.19709908
[31]  0.62609901 -0.27769044

$y
 [1] 0.8129496 0.3057851 0.5497771 0.3209877 0.6440678 0.4552239 0.6569767
 [8] 0.8526912 0.5566265 0.6225166 0.6794055 0.8265306 0.4782609 0.6988506
[15] 0.7218045 0.7519902 0.7132353 0.7172676 0.6502947 0.7014925 0.5701944
[22] 0.7774566 0.5408163 0.6056604 0.7636364 0.7946429 0.5868545 0.5204082
[29] 0.7547945 0.7000000 0.7350993 0.6304348</code></pre>
</div>
</div>
<p>For each of the above distributions, I will group based on if the data is normal or otherwise distributed. Then using the mean and variance from the summary (mean and variance) data frame I will be able to establish fake data for this data set upon which to build a model.</p>
<p><strong>The list of variables, in order, are below. This order corresponds with the order of plots from the above loop.</strong></p>
<ol type="1">
<li><p>mass</p></li>
<li><p>massSTD</p></li>
<li><p>w.lifted</p></li>
<li><p>w.liftedSTD</p></li>
<li><p>wing.ar</p></li>
<li><p>wing.arSTD</p></li>
<li><p>wing.length</p></li>
<li><p>wing.lengthSTD</p></li>
<li><p>mean.hor_acel</p></li>
<li><p>mean.hor_decel</p></li>
<li><p>mean.arc_avghvel</p></li>
<li><p>mean.total_vel</p></li>
<li><p>ss.pitch_roll</p></li>
<li><p>mean.pr_time</p></li>
<li><p>mean.pr_degrees</p></li>
<li><p>mean.arc_force</p></li>
<li><p>PRTpercent</p></li>
</ol>
<p><strong>Proposed Distributions</strong></p>
<p><em>Normal</em> 3. w.lifted 4. w.liftedSTD 5. wing.ar - appears to increase at end, hard to tell but most close to normal 6. wing.arSTD 7. wing.length 8. wing.lengthSTD 16. mean.arc_force</p>
<p><em>Beta</em> 1. mass - skewed right 2. massSTD 9. mean.hor_acel - left-skewed data 10. mean.hor_decel - left skewed data</p>
<p>11. mean.arc_avghvel - left skewed data</p>
<p>12. mean.total_vel - left skewed data</p>
<p>13.ss.pitch_roll - right skewed</p>
<p>14. mean.pr_time - right skwewed</p>
<p>15. mean.pr_degrees - left skewed data</p>
<p>17. PRTpercent - left skewed</p>
</section>
</section>
<section id="generating-fake-data" class="level2">
<h2 class="anchored" data-anchor-id="generating-fake-data">Generating Fake Data</h2>
<p>For each variable, I will create a fake data set that has the same mean and variance, with a sample size of 32 individuals (same as the Segre et al., 2015 paper) and a distribution that is consistent with the original data.</p>
<section id="weight-lifted" class="level3">
<h3 class="anchored" data-anchor-id="weight-lifted">Weight Lifted</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>w.lifted.simu <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span><span class="dv">32</span>, <span class="at">mean =</span> annas_summ[<span class="dv">3</span>,<span class="dv">2</span>], <span class="at">sd=</span> <span class="fu">sqrt</span>(annas_summ[<span class="dv">3</span>,<span class="dv">3</span>]))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(w.lifted.simu, <span class="at">col =</span> <span class="st">"blue"</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">9</span>))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(annas_clean<span class="sc">$</span>w.lifted, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(w.lifted.simu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="horizontal-acceleration" class="level3">
<h3 class="anchored" data-anchor-id="horizontal-acceleration">Horizontal Acceleration</h3>
<p>I am having difficulty creating fake data sets with Beta distributions. For now, I am making a normally distributed fake data set for horizontal acceleration (variable 9) so that I can work on building a model around it, but need to come back to this distribution issue.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>mean.hor_acel_simu <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span><span class="dv">32</span>, <span class="at">mean =</span> annas_summ[<span class="dv">9</span>,<span class="dv">2</span>], <span class="at">sd=</span> <span class="fu">sqrt</span>(annas_summ[<span class="dv">9</span>,<span class="dv">3</span>]))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mean.hor_acel_simu, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">11</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(annas_clean<span class="sc">$</span>mean.hor_acel, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mean.hor_acel_simu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="running-a-phenotype-performance-model" class="level1">
<h1>Running a Phenotype-Performance Model</h1>
<section id="creating-a-stan-model" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-stan-model">Creating a Stan Model</h2>
<p>To begin, I have started with a simple stan model, connecting a linear regression of weight lifted as a phenotype and mean horizontal acceleration as a performance variable. Below is the commented Stan code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data{</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   int&lt;lower=0&gt; n; //number of samples </span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   vector [n] wlifted; //independent variable in data, weight lifted</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   vector [n] mhoracel; //dependent varible, mean horizontal acceleration</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters{</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   real a; //real number that is intercept of linear regression</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   real b; //real number that is slope of linear regression </span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   real &lt;lower=0&gt; sigma; //real number that is variance </span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co"># model{</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   vector[n] yhat;</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   yhat = a + b*wlifted;</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   //setting priors for data</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   mhoracel ~ normal(yhat, sigma);</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   a ~ normal(0,5);</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   b ~ normal(0,10); </span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   sigma ~ normal(0,10);</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="running-stan-model" class="level2">
<h2 class="anchored" data-anchor-id="running-stan-model">Running Stan Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>annas_data_simu <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">length</span>(w.lifted.simu),</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">mhoracel =</span> <span class="fu">as.numeric</span>(mean.hor_acel_simu),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">wlifted =</span> <span class="fu">as.numeric</span>(w.lifted.simu)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>annas_fit <span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">file =</span> <span class="st">"annas_performance_model.stan"</span>, <span class="at">data =</span> annas_data_simu, <span class="at">iter =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'annas_performance_model' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 3.7e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.37 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)
Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)
Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)
Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.08767 seconds (Warm-up)
Chain 1:                0.074269 seconds (Sampling)
Chain 1:                0.161939 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'annas_performance_model' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 1e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.1 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)
Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)
Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)
Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)
Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)
Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.076628 seconds (Warm-up)
Chain 2:                0.08595 seconds (Sampling)
Chain 2:                0.162578 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'annas_performance_model' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 1.1e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.11 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 3: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 3: Iteration: 200 / 1000 [ 20%]  (Warmup)
Chain 3: Iteration: 300 / 1000 [ 30%]  (Warmup)
Chain 3: Iteration: 400 / 1000 [ 40%]  (Warmup)
Chain 3: Iteration: 500 / 1000 [ 50%]  (Warmup)
Chain 3: Iteration: 501 / 1000 [ 50%]  (Sampling)
Chain 3: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 3: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 3: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 3: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.08716 seconds (Warm-up)
Chain 3:                0.084497 seconds (Sampling)
Chain 3:                0.171657 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'annas_performance_model' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 1.2e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.12 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 4: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 4: Iteration: 200 / 1000 [ 20%]  (Warmup)
Chain 4: Iteration: 300 / 1000 [ 30%]  (Warmup)
Chain 4: Iteration: 400 / 1000 [ 40%]  (Warmup)
Chain 4: Iteration: 500 / 1000 [ 50%]  (Warmup)
Chain 4: Iteration: 501 / 1000 [ 50%]  (Sampling)
Chain 4: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 4: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 4: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 4: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.094387 seconds (Warm-up)
Chain 4:                0.088274 seconds (Sampling)
Chain 4:                0.182661 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(annas_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Inference for Stan model: annas_performance_model.
4 chains, each with iter=1000; warmup=500; thin=1; 
post-warmup draws per chain=500, total post-warmup draws=2000.

        mean se_mean   sd   2.5%    25%    50%    75%  97.5% n_eff Rhat
a       6.53    0.09 2.17   2.13   5.06   6.61   8.08  10.46   637    1
b      -0.03    0.01 0.36  -0.70  -0.29  -0.04   0.21   0.71   635    1
sigma   1.86    0.01 0.25   1.46   1.67   1.81   2.01   2.43   809    1
lp__  -35.32    0.04 1.24 -38.44 -35.88 -34.99 -34.41 -33.89   780    1

Samples were drawn using NUTS(diag_e) at Thu Mar  9 12:10:04 2023.
For each parameter, n_eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor on split chains (at 
convergence, Rhat=1).</code></pre>
</div>
</div>
</section>
</section>
<section id="section-4" class="level1">
<h1></h1>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p><strong>Arnold.</strong> 1983. Morphology, Performance and Fitness. <em>American Zoology</em> 23:347-361.</p>
<p><strong>Bergmann and McElroy.</strong> 2014. Many-to-Many Mapping of Phenotype to Performance: An Extension of the F-Matrix for Studying Functional Complexity. <em>Evolutionary Biology</em> 41:546–560. DOI 10.1007/s11692-014-9288-1</p>
<p><strong>Márquez-Luna et al.</strong> 2022. Genetic relatedness and morphology as drivers of interspecific dominance hierarchy in hummingbirds. <em>PeerJ.</em> DOI 10.7717/peerj.13331</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>