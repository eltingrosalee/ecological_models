<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rosalee Elting">

<title>A Model to Connect Hummingbird Phenotypes to Flight Performance</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Phenotype_to_permformance_model_files/libs/clipboard/clipboard.min.js"></script>
<script src="Phenotype_to_permformance_model_files/libs/quarto-html/quarto.js"></script>
<script src="Phenotype_to_permformance_model_files/libs/quarto-html/popper.min.js"></script>
<script src="Phenotype_to_permformance_model_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Phenotype_to_permformance_model_files/libs/quarto-html/anchor.min.js"></script>
<link href="Phenotype_to_permformance_model_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Phenotype_to_permformance_model_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Phenotype_to_permformance_model_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Phenotype_to_permformance_model_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Phenotype_to_permformance_model_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<link href="Phenotype_to_permformance_model_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="Phenotype_to_permformance_model_files/libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#project-introduction" id="toc-project-introduction" class="nav-link active" data-scroll-target="#project-introduction">Project Introduction</a>
  <ul class="collapse">
  <li><a href="#project-question" id="toc-project-question" class="nav-link" data-scroll-target="#project-question">Project Question</a></li>
  </ul></li>
  <li><a href="#method" id="toc-method" class="nav-link" data-scroll-target="#method">Method</a>
  <ul class="collapse">
  <li><a href="#arnolds-paradigm" id="toc-arnolds-paradigm" class="nav-link" data-scroll-target="#arnolds-paradigm">Arnoldâ€™s Paradigm</a></li>
  <li><a href="#structural-equation-model-sem" id="toc-structural-equation-model-sem" class="nav-link" data-scroll-target="#structural-equation-model-sem">Structural Equation Model (SEM)</a>
  <ul class="collapse">
  <li><a href="#piecewise-sem" id="toc-piecewise-sem" class="nav-link" data-scroll-target="#piecewise-sem">Piecewise SEM</a></li>
  <li><a href="#path-model" id="toc-path-model" class="nav-link" data-scroll-target="#path-model">Path Model</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#measurement-variables" id="toc-measurement-variables" class="nav-link" data-scroll-target="#measurement-variables">Measurement Variables</a></li>
  <li><a href="#calypte-anna-repository-data" id="toc-calypte-anna-repository-data" class="nav-link" data-scroll-target="#calypte-anna-repository-data"><em>Calypte anna</em> Repository Data</a>
  <ul class="collapse">
  <li><a href="#transforming-data" id="toc-transforming-data" class="nav-link" data-scroll-target="#transforming-data">Transforming Data</a></li>
  </ul></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a>
  <ul class="collapse">
  <li><a href="#creating-a-correlation-matrix" id="toc-creating-a-correlation-matrix" class="nav-link" data-scroll-target="#creating-a-correlation-matrix">Creating a Correlation Matrix</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#visualizing-original-data" id="toc-visualizing-original-data" class="nav-link" data-scroll-target="#visualizing-original-data">Visualizing Original Data</a>
  <ul class="collapse">
  <li><a href="#investigating-distributions-of-original-data" id="toc-investigating-distributions-of-original-data" class="nav-link" data-scroll-target="#investigating-distributions-of-original-data">Investigating Distributions of Original Data</a></li>
  <li><a href="#generating-fake-data" id="toc-generating-fake-data" class="nav-link" data-scroll-target="#generating-fake-data">Generating Fake Data</a></li>
  </ul></li>
  <li><a href="#running-a-phenotype-performance-model" id="toc-running-a-phenotype-performance-model" class="nav-link" data-scroll-target="#running-a-phenotype-performance-model">Running a Phenotype-Performance Model</a>
  <ul class="collapse">
  <li><a href="#creating-a-stan-model" id="toc-creating-a-stan-model" class="nav-link" data-scroll-target="#creating-a-stan-model">Creating a Stan Model</a></li>
  <li><a href="#running-stan-model" id="toc-running-stan-model" class="nav-link" data-scroll-target="#running-stan-model">Running Stan Model</a></li>
  </ul></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">A Model to Connect Hummingbird Phenotypes to Flight Performance</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rosalee Elting </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="project-introduction" class="level1">
<h1>Project Introduction</h1>
<p>For my project, I propose methods to understand the social dominance of hummingbirds and how social hierarchies are maintained. To evaluate this, I will use both field and lab work to create a model that reflects the phenotype &gt; performance &gt; fitness paradigm presented by Arnold in 1983 (Arnold, 1983). The actual variables I will measure are outlined below in the <strong>Measurement Variables</strong> section. In brief, during the summer of 2023 at the Field Research Station at Fort Missoula, I will conduct experiments up with dyadic trials between two male hummingbirds where a limiting resource is introduced (nectar or perches) to establish which individual maintains access to this resource and chases away an opponent. I will then connect these wins to traits that vary between individuals. These phenotypes will be morphometric traits, such as body and wing morphological. Performance will be evaluated via analysis of flight kinematic complexity and metabolic efficiency.</p>
<p>Lastly, with these characteristics I seek to understand how phenotypes and performances connect to overall fitness in an ecological landscape. To do this, I will be using dominance over a nectar resource landscape-and presumably the resulting access to food and matesâ€“as a proxy for an individualâ€™s overall fitness. I will understand which individuals are dominant from fight data from the field and winning individualsâ€™ phenotypes. I can then combine these data with the fine-tuned phenotypic data and one-on-one fight results from lab trials. With this, I seek to establish what phenotypes and fitness performance traits are most predictable of social dominance hierarchies in hummingbirds.</p>
<section id="project-question" class="level2">
<h2 class="anchored" data-anchor-id="project-question">Project Question</h2>
<p>The above summarizes my projectâ€™s overall goals. First, I will investigate only the phenotype to performance transitions in my model. I will explote if individualâ€™s performance is predictable and can be modeled through Bayesian methods. As a result of this simplified goal, I ask:</p>
<p><em>What variables in a complex suite of hummingbird morphological traits and flight maneuvers predict flight characteristics that are associated with increased speed and maneuverability?</em></p>
</section>
</section>
<section id="method" class="level1">
<h1>Method</h1>
<section id="arnolds-paradigm" class="level2">
<h2 class="anchored" data-anchor-id="arnolds-paradigm">Arnoldâ€™s Paradigm</h2>
<p>Overall, I will be approaching this work using the Arnoldâ€™s Paradigm proposed in his 1983 paper. The framework below (Bergmann and McElroy, 2014) illustrates this experiment method graphically.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="matrix_test.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">(Bergmann and McElroy, 2014)</figcaption><p></p>
</figure>
</div>
</section>
<section id="structural-equation-model-sem" class="level2">
<h2 class="anchored" data-anchor-id="structural-equation-model-sem">Structural Equation Model (SEM)</h2>
<p>To approach this proposed Arnoldâ€™s Paradigm, I will first need to understand the relative influence of a birdâ€™s actual body condition, an unknown variable we canâ€™t fully know, on the phenotypic traits I will measure. I will also need to understand the relative influence of each phenotypic trait on the flight and metabolic performance measures that I measure. To do this, I will be using a <strong>Structural Equation Model</strong>, which is an appropriate model to represent how latent variables (those that are thought to exist but cannot be directly observed, <em>e.g.&nbsp;body quality</em>) are causally connected to variables that i can measure (<em>e.g.&nbsp;flight and metabolic performance metrics)</em>.</p>
<p>Structural Equation Models are representing the relative contribution of each exogenous variable (solely predictors, <em>e.g.&nbsp;phenotypes)</em> to a causal relationship with one or several exogenous variables (both predicted and predictive variables, <em>e.g.&nbsp;flight performance)</em>. Between each variable, a path can be drawn. Multiple paths each represent a partial regression coefficient, illustration the join influence of each predictor on the response variableâ€™s value.</p>
<section id="piecewise-sem" class="level3">
<h3 class="anchored" data-anchor-id="piecewise-sem">Piecewise SEM</h3>
<p>For each combination of endogenous variables, relationships are estimated as local estimations, meaning they arenâ€™t dependent on other relationships between one of the variables with another set of variables. This is called <strong>Piecewise SEM</strong> and allows for evaluation of each relationship individually, then stringing together these inferences, in a piecewise fashion.</p>
</section>
<section id="path-model" class="level3">
<h3 class="anchored" data-anchor-id="path-model">Path Model</h3>
<p>I will represent this model with a path diagram, which illustrates each piece of the piecewise SEM visually. This path diagram also assumes no reversals between variables (unidirectional) and no changes in variable values that are informed by a latter variables value (feedback). These assumptions are appropriate for the variables of this project.</p>
<p>Paths in a path model can be summarize into a matrix of regressions between each pairs of variables. This matrix is valuable, as it will be modelling data that I have input, but producing a matrix of regressions. I can then input secondary data sets to test if this matrix of regressions in secondary data sets match those in the original data set.</p>
<p>Below is the proposed path model, without regression values, that I intend to quantify. Red arrows indicate paths that I propose have large influences on the endogenous variables while gray arrows are those that I hypothesize will have weak correlations.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="path_model.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Phenotype-Performance Path Model</figcaption><p></p>
</figure>
</div>
</section>
</section>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<section id="measurement-variables" class="level2">
<h2 class="anchored" data-anchor-id="measurement-variables">Measurement Variables</h2>
<p>I will be using a modified version of the <a href="#arnolds-paradigm">Arnoldâ€™s Paradigm</a>, but instead of comparing the phenotype-performance relationship of each species, I will be evaluating this on an individual level. My measurements, and their categories, will be:</p>
<p><strong>Phenotypic Measures:</strong></p>
<ul>
<li><p>Body Mass</p></li>
<li><p>Wing Aspect Ratio</p></li>
<li><p>Burst Muscle Capacity</p></li>
</ul>
<p><strong>Performance Measures:</strong></p>
<ul>
<li><p>Flight accelerations</p></li>
<li><p>Arcing turn speed and radii</p></li>
<li><p>Maneuvering velocity</p></li>
<li><p>Centripetal Acceleration</p></li>
<li><p>Percentage of turns that are complex pitch-roll turns</p></li>
</ul>
</section>
<section id="calypte-anna-repository-data" class="level2">
<h2 class="anchored" data-anchor-id="calypte-anna-repository-data"><em>Calypte anna</em> Repository Data</h2>
<p>I will be holding 6 Calliope Hummingbirds (<em>Selasphorus calliope</em>) captive in the spring of 2023. As I do not yet have data, I have found public repositories of data similar to that which I will collect.</p>
<p>Below is code I have written to explore data collected in Segre et al., 2015, an <em>eLife</em> publication exploring phenotypes and flight performance. The authors evaluated this data using an <strong>information-theoretic approach</strong> which compares the several possible scenarios and weights their relative predictive importance. The authors evaluated these data using a canned R function, nlme, therefore I would like to evaluate the same data with the <a href="#structural-equation-model-sem">Structural Equation Model (SEM)</a> I have proposed already.</p>
<p>Below are the steps I have taken to first understand this data:</p>
<ul>
<li>Load the necessary libraries</li>
</ul>
<div class="cell">

</div>
<ul>
<li>Load the csv of data from this publication and print the heading of the data.</li>
</ul>
<div class="cell">

</div>
<ul>
<li><p>I next am filtering and cleaning this data. I am removing data from solo trials, and keeping only competitive trials. The assumption is that birds perform flight maneuvers with increases speed or maneuverability in the presence of another individual. Therefore, I only include data from competitive trials. Further I am selecting data I am interested in from this original data set.</p>
<ul>
<li>In this code chunk, I also create a summary data frame with means and variances for each variable. This chunk is not printed for simplicity.</li>
</ul></li>
</ul>
<div class="cell">

</div>
<section id="transforming-data" class="level3">
<h3 class="anchored" data-anchor-id="transforming-data">Transforming Data</h3>
<p>Because I am investigating the covariance of multiple variables, yet these variables have different magnitude of values, this can be an issue when comparing the relative influence of variables. To address this, I will conduct a Z- transformation to standardize all my simulated data using a X transformation, which follows this formula:</p>
<p><span id="eq-z-transformation"><span class="math display">\[
Z_x = \frac{(X_i - \bar X)}{sd(X)}
\tag{1}\]</span></span></p>
</section>
</section>
<section id="section" class="level2" data-link="Generating Fake Data">
<h2 data-link="Generating Fake Data" class="anchored" data-anchor-id="section"></h2>
<p>I will execute this in R, creating a new, standardized data set., called annas_trans to represent the transformed values</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Phenotype_to_permformance_model_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>I conducted my own math to confirm the scale transformation works and with the above figure I am comfortable that this is properly transforming my data.</p>
<section id="creating-a-correlation-matrix" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-correlation-matrix">Creating a Correlation Matrix</h3>
<p>I now would like to produce a correlation coefficient for the relationship between each of the studied variables in this study. This will give me the ability to have linear regressions between each variable, which will serve as the parameters in my SEM path model.</p>
<div class="cell">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["mass"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["w.lifted"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["wing.ar"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["wing.length"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["mean.hor_acel"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mean.hor_decel"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mean.arc_avghvel"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["mean.total_vel"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["ss.pitch_roll"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["mean.pr_time"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["mean.pr_degrees"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["mean.arc_force"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["PRTpercent"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.000000000","2":"-0.02138795","3":"0.0090924068","4":"-0.125671520","5":"0.26375320","6":"-0.34467853","7":"0.1316777","8":"0.25819300","9":"0.058580403","10":"-0.22067141","11":"0.19098411","12":"0.26677483","13":"0.1638053140","_rn_":"mass"},{"1":"-0.021387948","2":"1.00000000","3":"-0.5621968550","4":"-0.097510379","5":"0.09062024","6":"-0.08249081","7":"0.1895732","8":"-0.06902315","9":"-0.177529316","10":"0.01791766","11":"-0.34510147","12":"0.06900295","13":"0.2395037940","_rn_":"w.lifted"},{"1":"0.009092407","2":"-0.56219685","3":"1.0000000000","4":"-0.235933386","5":"0.57272943","6":"-0.57785724","7":"0.5344996","8":"0.70538166","9":"0.334573752","10":"-0.58833225","11":"0.57028723","12":"0.51045199","13":"0.0008849119","_rn_":"wing.ar"},{"1":"-0.125671520","2":"-0.09751038","3":"-0.2359333856","4":"1.000000000","5":"-0.46825680","6":"0.54245316","7":"-0.6114643","8":"-0.54469652","9":"0.006335836","10":"0.27519887","11":"-0.29603013","12":"-0.47572009","13":"-0.3632473528","_rn_":"wing.length"},{"1":"0.263753201","2":"0.09062024","3":"0.5727294267","4":"-0.468256803","5":"1.00000000","6":"-0.97664266","7":"0.9113218","8":"0.89172407","9":"0.253748158","10":"-0.80753106","11":"0.56670115","12":"0.83995391","13":"0.3162069436","_rn_":"mean.hor_acel"},{"1":"-0.344678525","2":"-0.08249081","3":"-0.5778572378","4":"0.542453159","5":"-0.97664266","6":"1.00000000","7":"-0.9083660","8":"-0.91781851","9":"-0.258304578","10":"0.81026905","11":"-0.53412158","12":"-0.83426842","13":"-0.3898041660","_rn_":"mean.hor_decel"},{"1":"0.131677730","2":"0.18957325","3":"0.5344995990","4":"-0.611464291","5":"0.91132185","6":"-0.90836598","7":"1.0000000","8":"0.86456335","9":"0.258795556","10":"-0.71313785","11":"0.45362510","12":"0.81391060","13":"0.3169526970","_rn_":"mean.arc_avghvel"},{"1":"0.258192996","2":"-0.06902315","3":"0.7053816644","4":"-0.544696521","5":"0.89172407","6":"-0.91781851","7":"0.8645634","8":"1.00000000","9":"0.211136555","10":"-0.80567359","11":"0.57775316","12":"0.80119958","13":"0.2391295871","_rn_":"mean.total_vel"},{"1":"0.058580403","2":"-0.17752932","3":"0.3345737524","4":"0.006335836","5":"0.25374816","6":"-0.25830458","7":"0.2587956","8":"0.21113656","9":"1.000000000","10":"-0.35605397","11":"0.24473284","12":"0.29010418","13":"0.2697751674","_rn_":"ss.pitch_roll"},{"1":"-0.220671409","2":"0.01791766","3":"-0.5883322544","4":"0.275198868","5":"-0.80753106","6":"0.81026905","7":"-0.7131378","8":"-0.80567359","9":"-0.356053972","10":"1.00000000","11":"-0.37588077","12":"-0.66242992","13":"-0.2711736597","_rn_":"mean.pr_time"},{"1":"0.190984115","2":"-0.34510147","3":"0.5702872319","4":"-0.296030132","5":"0.56670115","6":"-0.53412158","7":"0.4536251","8":"0.57775316","9":"0.244732840","10":"-0.37588077","11":"1.00000000","12":"0.58003676","13":"-0.0472823253","_rn_":"mean.pr_degrees"},{"1":"0.266774832","2":"0.06900295","3":"0.5104519882","4":"-0.475720087","5":"0.83995391","6":"-0.83426842","7":"0.8139106","8":"0.80119958","9":"0.290104180","10":"-0.66242992","11":"0.58003676","12":"1.00000000","13":"0.0179942245","_rn_":"mean.arc_force"},{"1":"0.163805314","2":"0.23950379","3":"0.0008849119","4":"-0.363247353","5":"0.31620694","6":"-0.38980417","7":"0.3169527","8":"0.23912959","9":"0.269775167","10":"-0.27117366","11":"-0.04728233","12":"0.01799422","13":"1.0000000000","_rn_":"PRTpercent"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="visualizing-original-data" class="level1">
<h1>Visualizing Original Data</h1>
<p>Here, I visualize the original data from this experiment from Segre et al.</p>
<div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- as.factor(0)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  viz &lt;- annas_clean %&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#    cross_join(x, copy = TRUE)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  colNames &lt;- names(viz)[1:17]</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  for (i in colNames) {</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#    plot &lt;- ggplot(viz, aes_string(x= viz$y, y = i))+ </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#      geom_violin(draw_quantiles = c(0.25, 0.5, 0.75))+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#      geom_point() +</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#      theme_classic()</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   print(plot)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   Sys.sleep(2)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#    </span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">

</div>
</div>
<section id="investigating-distributions-of-original-data" class="level3">
<h3 class="anchored" data-anchor-id="investigating-distributions-of-original-data">Investigating Distributions of Original Data</h3>
<p>I here explore the distributions of the original data. These are many figures, so I wonâ€™t print for the time being.</p>
<div class="cell">

</div>
<p>I conclude that some of these data are distributed non-normally and are likely best represented as a beta distribution. For ease of this model, I will estimate that each variable is distributed normally to make for an easier time in <a href="#generating-fake-data">Generating Fake Data</a>.</p>
</section>
<section id="generating-fake-data" class="level2">
<h2 class="anchored" data-anchor-id="generating-fake-data">Generating Fake Data</h2>
<p>For each variable, I will create a fake data set that has the same mean and variance, with a sample size of 32 individuals (same as the Segre et al., 2015 paper) and a normal distribution.</p>
<p>Below is code I use to generate fake data for each of the variables Iâ€™m investigating and visualizations of the data generated.</p>
<p>First, here is the heading of the data I generated.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<p>In these visualizations, <strong>blue points represent the simulated data and red points represent the real data.</strong> This code will cycle through and generate data and visualizations for several, but not all of the <a href="#measurement-variables">Measurement Variables</a> (in the interest of space).</p>
<div class="cell">

</div>
</section>
</section>
<section id="running-a-phenotype-performance-model" class="level1">
<h1>Running a Phenotype-Performance Model</h1>
<section id="creating-a-stan-model" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-stan-model">Creating a Stan Model</h2>
<p>I have only begun to create a Stan Model, but intend to use the method published in Merkle et al., 2021 and am currently working on understanding this method.</p>
<p>I will input the Stan code below.</p>
</section>
<section id="running-stan-model" class="level2">
<h2 class="anchored" data-anchor-id="running-stan-model">Running Stan Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># annas_data_simu &lt;- list(</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#       n = length(w.lifted.simu),</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#       mhoracel = as.numeric(mean.hor_acel_simu),</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#       wlifted = as.numeric(w.lifted.simu)</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># annas_fit &lt;- stan(file = "annas_performance_model.stan", data = annas_data_simu, iter = 1000, chains = 4)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print(annas_fit)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="section-1" class="level1">
<h1></h1>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p><strong>Arnold.</strong> 1983. Morphology, Performance and Fitness. <em>American Zoology</em> 23:347-361.</p>
<p><strong>Bergmann and McElroy.</strong> 2014. Many-to-Many Mapping of Phenotype to Performance: An Extension of the F-Matrix for Studying Functional Complexity. <em>Evolutionary Biology</em> 41:546â€“560. DOI 10.1007/s11692-014-9288-1</p>
<p><strong>Garnier-Villarreal, M. and Jorgensen, T.D.</strong> 2019.Adapting fit indices for Bayesian structural equation modeling: Comparison to maximum likelihood. <em>Psychological Methods.</em> DOI: 10.1037/met0000224</p>
<p><strong>MÃ¡rquez-Luna et al.</strong> 2022. Genetic relatedness and morphology as drivers of interspecific dominance hierarchy in hummingbirds. <em>PeerJ.</em> DOI 10.7717/peerj.13331</p>
<p><strong>Merkle, E.C. et al.</strong> 2021. Efficient Bayesian Structural Equation Modeling in Stan. <em>Journal of Statistical Software.</em> DOI: 10.18637/jss.v100.i06.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>